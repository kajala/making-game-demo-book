<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Engine Core: Node.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8-20040824 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a></div>
<h1>Node.h</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _HGR_NODE_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _HGR_NODE_H</span>
00003 <span class="preprocessor"></span>
00004 
00005 <span class="preprocessor">#include &lt;lang/String.h&gt;</span>
00006 <span class="preprocessor">#include &lt;lang/Object.h&gt;</span>
00007 <span class="preprocessor">#include &lt;math/float3x4.h&gt;</span>
00008 
00009 
00010 <span class="keyword">namespace </span>gr {
00011     <span class="keyword">class </span>Context;}
00012 
00013 
00014 <span class="keyword">namespace </span>hgr
00015 {
00016 
00017 
00018 <span class="keyword">class </span>Camera;
00019 <span class="keyword">class </span>SceneInputStream;
00020 <span class="keyword">class </span>SceneOutputStream;
00021 
00022 
<a name="l00032"></a><a class="code" href="../../d4/db1/classhgr_1_1Node.html">00032</a> <span class="keyword">class </span><a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a> :
00033     <span class="keyword">public</span> lang::Object
00034 {
00035 <span class="keyword">public</span>:
00036     <span class="comment">/*</span>
00037 <span class="comment">     * Node class identifier. Used by the implementation to </span>
00038 <span class="comment">     * avoid depending on RTTI, since this class might </span>
00039 <span class="comment">     * be need to be ported to some platforms which do not </span>
00040 <span class="comment">     * support run-time type information.</span>
00041 <span class="comment">     */</span>
<a name="l00042"></a><a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12">00042</a>     <span class="keyword">enum</span> <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12">NodeClassId</a>
00043     {
00045         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12w8">NODE_OTHER</a>  = (0&lt;&lt;4),
00047         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12w1">NODE_CAMERA</a> = (1&lt;&lt;4),
00049         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12w5">NODE_LIGHT</a>  = (2&lt;&lt;4),
00051         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12w11">NODE_VISUAL</a> = (3&lt;&lt;4),
00053         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w12w10">NODE_SCENE</a>  = (4&lt;&lt;4)
00054     };
00055 
00056     <span class="comment">/*</span>
00057 <span class="comment">     * Internal node state flags.</span>
00058 <span class="comment">     */</span>
<a name="l00059"></a><a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13">00059</a>     <span class="keyword">enum</span> <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13">NodeFlags</a>
00060     {
00062         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w4">NODE_ENABLED</a>                = 1, <span class="comment">// bit 0</span>
00064 <span class="comment"></span>        <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w9">NODE_RENDERABLE</a>             = 2, <span class="comment">// bit 1</span>
00066 <span class="comment"></span>        <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w6">NODE_LIGHTTYPE</a>              = (3&lt;&lt;2), <span class="comment">// bits 2:3</span>
00068 <span class="comment"></span>        <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w7">NODE_LIGHTTYPE_SHIFT</a>        = 2,
00070         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w2">NODE_CLASS</a>                  = (15&lt;&lt;4), <span class="comment">// bits 4:7</span>
00072 <span class="comment"></span>        <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w0">NODE_BOUNDWORLDSPACE</a>        = (1&lt;&lt;8),
00074         <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w3">NODE_DEFAULTS</a>               = <a class="code" href="../../d4/db1/classhgr_1_1Node.html#w13w4">NODE_ENABLED</a> + NODE_OTHER,
00075     };
00076 
00080     <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a14">Node</a>();
00081 
00082     ~<a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>();
00083 
00087     <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a14">Node</a>( <span class="keyword">const</span> <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>&amp; other );
00088 
00092     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a19">setName</a>( <span class="keyword">const</span> <a class="code" href="../../da/d2e/classlang_1_1String.html">lang::String</a>&amp; name );
00093 
00097     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a22">setTransform</a>( <span class="keyword">const</span> <a class="code" href="../../d0/d45/classmath_1_1float3x4.html">math::float3x4</a>&amp; transform );
00098 
00102     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a20">setPosition</a>( <span class="keyword">const</span> <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>&amp; position );
00103 
00107     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a21">setRotation</a>( <span class="keyword">const</span> <a class="code" href="../../db/d00/classmath_1_1float3x3.html">math::float3x3</a>&amp; rotation );
00108 
00114     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a10">lookAt</a>( <span class="keyword">const</span> <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>* target, <span class="keyword">const</span> <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>&amp; up = <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>(0,1,0) );
00115 
00121     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a10">lookAt</a>( <span class="keyword">const</span> <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>&amp; target, <span class="keyword">const</span> <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>&amp; up = <a class="code" href="../../d5/d00/classmath_1_1float3.html">math::float3</a>(0,1,0) );
00122 
00127     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a8">linkTo</a>( <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>* parent );
00128 
00133     <span class="keywordtype">void</span>                    <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a25">unlink</a>();
00134 
00135     <span class="comment">/*</span>
00136 <span class="comment">     * Sets node transform index. Used by rendering implementation </span>
00137 <span class="comment">     * to keep track of cached world transforms.</span>
00138 <span class="comment">     */</span>
00139     <span class="keywordtype">void</span>                    setTransformIndex( <span class="keywordtype">int</span>  );
00140 
00144     <span class="keyword">const</span> <a class="code" href="../../da/d2e/classlang_1_1String.html">lang::String</a>&amp;     <a class="code" href="../../d4/db1/classhgr_1_1Node.html#a11">name</a>() const;
00145 
00149     const math::float3x4&amp;   transform() const;
00150 
00154     math::float3x3          rotation() const;
00155 
00159     math::float3            position() const;
00160     
00164     math::float3x4          worldTransform() const;
00165 
00170     const math::float3x4&amp;   getCachedTransform( gr::Context* context ) const;
00171 
00175     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   parent() const;
00176     
00180     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   firstChild() const;
00181     
00185     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   getNextChild( const <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>* child ) const;
00186 
00190     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   root() const;
00191 
00195     <span class="keywordtype">bool</span>                    hasParent( const <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>* other ) const;
00196 
00201     <span class="keywordtype">int</span>                     depth() const;
00202 
00210     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   next() const;
00211 
00216     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   getNodeByName( const lang::String&amp; name ) const;
00217 
00222     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                   findNodeByName( const lang::String&amp; name ) const;
00223 
00224     <span class="comment">/*</span>
00225 <span class="comment">     * Returns type of the node. Used by the implementation to </span>
00226 <span class="comment">     * avoid depending on RTTI.</span>
00227 <span class="comment">     */</span>
00228     NodeClassId             classId() const;
00229 
00230 protected:
00231     <span class="comment">/*</span>
00232 <span class="comment">     * Sets class id of the node.</span>
00233 <span class="comment">     * Warning: This is not RTTI checked.</span>
00234 <span class="comment">     */</span>
00235     <span class="keywordtype">void</span>    setClassId( NodeClassId type );
00236 
00237     <span class="comment">/*</span>
00238 <span class="comment">     * Sets node flags. Node flags are internal representation</span>
00239 <span class="comment">     * method of some node options. This method, along with flags(),</span>
00240 <span class="comment">     * is used only for loading/saving of nodes data.</span>
00241 <span class="comment">     */</span>
00242     <span class="keywordtype">void</span>    setFlags( <span class="keywordtype">int</span> flags );
00243 
00244     <span class="comment">/*</span>
00245 <span class="comment">     * Sets a single flag enabled/disabled.</span>
00246 <span class="comment">     */</span>
00247     <span class="keywordtype">void</span>    setFlag( NodeFlags flag, <span class="keywordtype">bool</span> enabled );
00248 
00249     <span class="comment">/* </span>
00250 <span class="comment">     * Returns node flags. Node flags are internal representation</span>
00251 <span class="comment">     * method of some node options. This method, along with setFlags,</span>
00252 <span class="comment">     * is used only for loading/saving of node data.</span>
00253 <span class="comment">     */</span>
00254     <span class="keywordtype">int</span>     flags() const;
00255 
00256     <span class="comment">/*</span>
00257 <span class="comment">     * Gets a single flag enabled/disabled state.</span>
00258 <span class="comment">     */</span>
00259     <span class="keywordtype">bool</span>    getFlag( NodeFlags flag ) const;
00260 
00261 private:
00262     friend class <a class="code" href="../../d9/db3/classhgr_1_1Camera.html">Camera</a>;
00263     friend class SceneInputStream;
00264     friend class SceneOutputStream;
00265 
00266     math::float3x4                  m_modeltm;
00267     mutable <span class="keywordtype">short</span>                   m_flags;
00268     mutable <span class="keywordtype">short</span>                   m_tmindex;
00269     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                           m_parent;
00270     P(<a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>)                         m_child;
00271     P(<a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>)                         m_next;
00272     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>*                           m_previous;
00273     lang::String                    m_name;
00274 
00275     <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>&amp; operator=( const <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>&amp; );
00276 };
00277 
00278 
00279 #include &lt;hgr/Node.inl&gt;
00280 
00281 
00282 } <span class="comment">// hgr</span>
00283 
00284 
00285 #endif <span class="comment">// _HGR_NODE_H</span>
00286 
00287 <span class="comment">// Copyright (C) 2005 Jani Kajala. All rights reserved. Consult your license regarding permissions and restrictions.</span>
</pre></div><br><br><small>Copyright (C) 2004 Jani Kajala. All rights reserved. Consult your license regarding permissions and restrictions.</small><br><br></body></html>
