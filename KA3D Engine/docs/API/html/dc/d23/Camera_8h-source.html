<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Engine Core: Camera.h Source File</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8-20040824 -->
<div class="qindex"><a class="qindex" href="../../index.html">Main&nbsp;Page</a> | <a class="qindex" href="../../modules.html">Modules</a> | <a class="qindex" href="../../hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="../../classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="../../annotated.html">Class&nbsp;List</a> | <a class="qindex" href="../../files.html">File&nbsp;List</a> | <a class="qindex" href="../../functions.html">Class&nbsp;Members</a></div>
<h1>Camera.h</h1><div class="fragment"><pre class="fragment">00001 <span class="preprocessor">#ifndef _HGR_CAMERA_H</span>
00002 <span class="preprocessor"></span><span class="preprocessor">#define _HGR_CAMERA_H</span>
00003 <span class="preprocessor"></span>
00004 
00005 <span class="preprocessor">#include &lt;hgr/Node.h&gt;</span>
00006 <span class="preprocessor">#include &lt;hgr/LightSorter.h&gt;</span>
00007 <span class="preprocessor">#include &lt;hgr/ViewFrustum.h&gt;</span>
00008 <span class="preprocessor">#include &lt;lang/Array.h&gt;</span>
00009 <span class="preprocessor">#include &lt;math/float4x4.h&gt;</span>
00010 
00011 
00012 <span class="keyword">namespace </span>gr {
00013     <span class="keyword">class </span>Shader;
00014     <span class="keyword">class </span>Context;}
00015 
00016 
00017 <span class="keyword">namespace </span>hgr
00018 {
00019 
00020 
00021 <span class="keyword">class </span>Light;
00022 <span class="keyword">class </span>Visual;
00023 
00024 
<a name="l00033"></a><a class="code" href="../../d9/db3/classhgr_1_1Camera.html">00033</a> <span class="keyword">class </span><a class="code" href="../../d9/db3/classhgr_1_1Camera.html">Camera</a> : 
00034     <span class="keyword">public</span> <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>
00035 {
00036 <span class="keyword">public</span>:
<a name="l00040"></a><a class="code" href="../../dd/d50/structhgr_1_1Camera_1_1Statistics.html">00040</a>     <span class="keyword">struct </span><a class="code" href="../../dd/d50/structhgr_1_1Camera_1_1Statistics.html">Statistics</a>
00041     {
<a name="l00043"></a><a class="code" href="../../dd/d50/structhgr_1_1Camera_1_1Statistics.html#o1">00043</a>         <span class="keywordtype">int</span> visualsBeforeCull;
<a name="l00045"></a><a class="code" href="../../dd/d50/structhgr_1_1Camera_1_1Statistics.html#o0">00045</a>         <span class="keywordtype">int</span> visualsAfterCull;
00046 
00048         <span class="keywordtype">void</span> <a class="code" href="../../dd/d50/structhgr_1_1Camera_1_1Statistics.html#a0">reset</a>();
00049     } statistics;
00050 
00051     <span class="comment">/*</span>
00052 <span class="comment">     * Temporary buffers used in rendering.</span>
00053 <span class="comment">     */</span>
00054     <span class="keyword">class </span>TempBuffers
00055     {
00056     <span class="keyword">public</span>:
00057         <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;math::float4x4&gt;</a> bonematrices;
00058         <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;math::float4x4*&gt;</a>    bonematrixp;
00059     };
00060 
00064     <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a8">Camera</a>();
00065 
00069     <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a8">Camera</a>( <span class="keyword">const</span> <a class="code" href="../../d9/db3/classhgr_1_1Camera.html">Camera</a>&amp; other );
00070 
00072     ~<a class="code" href="../../d9/db3/classhgr_1_1Camera.html">Camera</a>();
00073 
00077     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a19">setHorizontalFov</a>( <span class="keywordtype">float</span> horzFov );
00078 
00082     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a18">setFront</a>( <span class="keywordtype">float</span> front );
00083     
00087     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a17">setBack</a>( <span class="keywordtype">float</span> back );
00088 
00093     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a16">render</a>( <a class="code" href="../../da/dea/classgr_1_1Context.html">gr::Context</a>* context );
00094 
00104     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a16">render</a>( <a class="code" href="../../da/dea/classgr_1_1Context.html">gr::Context</a>* context, <span class="keywordtype">int</span> minpriority, <span class="keywordtype">int</span> maxpriority,
00105                 <span class="keyword">const</span> <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Visual*&gt;</a>&amp; visuals, <span class="keyword">const</span> <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;int&gt;</a>&amp; priorities,
00106                 <a class="code" href="../../df/dbc/classhgr_1_1LightSorter.html">LightSorter</a>* lightsorter );
00107 
00113     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a6">cacheTransforms</a>( <a class="code" href="../../da/dea/classgr_1_1Context.html">gr::Context</a>* context, <span class="keyword">const</span> <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Node*&gt;</a>&amp; nodes );
00114 
00120     <span class="keywordtype">void</span>    <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a9">cullVisuals</a>( <span class="keyword">const</span> <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Node*&gt;</a>&amp; nodes, <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Visual*&gt;</a>&amp; visuals );
00121 
00125     <span class="keywordtype">float</span>   <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a10">front</a>() const;
00126     
00130     <span class="keywordtype">float</span>   back() const;
00131 
00135     <span class="keywordtype">float</span>   horizontalFov() const;
00136 
00140     <span class="keywordtype">float</span>   verticalFov() const;
00141 
00145     math::float4x4          projectionTransform() const;
00146 
00150     math::float3x4          viewTransform() const;
00151 
00155     math::float4x4          viewProjectionTransform() const;
00156 
00164     const math::float3x4&amp;   getCachedWorldTransform( <a class="code" href="../../d4/db1/classhgr_1_1Node.html">Node</a>* node ) const;
00165 
00171     const math::float3x4&amp;   cachedWorldTransform() const;
00172 
00178     const math::float3x4&amp;   cachedViewTransform() const;
00179 
00185     const math::float4x4&amp;   cachedProjectionTransform() const;
00186 
00192     const math::float4x4&amp;   cachedViewProjectionTransform() const;
00193 
00199     const math::float4x4&amp;   cachedScreenViewProjectionTransform() const;
00200 
00206     lang::Array&lt;<a class="code" href="../../d6/d28/classhgr_1_1Light.html">Light</a>*&gt;&amp;    getLightsSortedByDistance( const math::float3&amp; worldpos ) const;
00207 
00208     <span class="comment">/*</span>
00209 <span class="comment">     * Returns camera temporary buffers used in rendering.</span>
00210 <span class="comment">     */</span>
00211     TempBuffers&amp;            tempBuffers()<span class="keyword"> const     </span>{<span class="keywordflow">return</span> m_temp;}
00212 
00213 <span class="keyword">private</span>:
00214     <span class="comment">/* Helper class used to sort visuals. */</span>
00215     <span class="keyword">class </span>VisualSorter
00216     {
00217     <span class="keyword">public</span>:
00218         Visual* obj;
00219         <span class="keywordtype">float</span>   depth;
00220 
00221         <span class="keywordtype">bool</span>    operator&lt;( <span class="keyword">const</span> VisualSorter&amp; other )<span class="keyword"> const    </span>{<span class="keywordflow">return</span> depth &lt; other.depth;}
00222     };
00223 
00224     ViewFrustum             m_frustum;
00225     <a class="code" href="../../d0/d45/classmath_1_1float3x4.html">math::float3x4</a>          m_worldtm;
00226     <a class="code" href="../../d0/d45/classmath_1_1float3x4.html">math::float3x4</a>          m_viewtm;
00227     <a class="code" href="../../d9/dbc/classmath_1_1float4x4.html">math::float4x4</a>          m_projtm;
00228     <a class="code" href="../../d9/dbc/classmath_1_1float4x4.html">math::float4x4</a>          m_viewprojtm;
00229     <a class="code" href="../../d9/dbc/classmath_1_1float4x4.html">math::float4x4</a>          m_screenviewprojtm;
00230     <span class="keyword">mutable</span> TempBuffers     m_temp;
00231 
00232     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;math::float3x4&gt;</a> m_worldTransformCache; <span class="comment">// used by cacheTransforms</span>
00233     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Node*&gt;</a>              m_nodes; <span class="comment">// used by simple render</span>
00234     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;Visual*&gt;</a>            m_visuals; <span class="comment">// used by simple render</span>
00235     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;gr::Shader*&gt;</a>        m_shaders; <span class="comment">// used by simple render</span>
00236     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;int&gt;</a>                m_priorities; <span class="comment">// used by simple render</span>
00237     LightSorter                     m_lightSorter; <span class="comment">// used by simple render</span>
00238     LightSorter*                    m_lightSorterPtr; <span class="comment">// used by getLightsSortedByDistance</span>
00239     <a class="code" href="../../d1/d9c/classlang_1_1Array.html">lang::Array&lt;VisualSorter&gt;</a>       m_visualSorter; <span class="comment">// used by cullVisuals</span>
00240 
00241     <a class="code" href="../../d9/db3/classhgr_1_1Camera.html#a8">Camera</a>&amp; <a class="code" href="../../dc/d47/classlang_1_1Object.html#a3">operator=</a>( <span class="keyword">const</span> Camera&amp; other );
00242 };
00243 
00244 
00245 <span class="preprocessor">#include &lt;hgr/Camera.inl&gt;</span>
00246 
00247 
00248 } <span class="comment">// hgr</span>
00249 
00250 
00251 <span class="preprocessor">#endif // _HGR_CAMERA_H</span>
00252 <span class="preprocessor"></span>
00253 <span class="comment">// Copyright (C) 2005 Jani Kajala. All rights reserved. Consult your license regarding permissions and restrictions.</span>
</pre></div><br><br><small>Copyright (C) 2004 Jani Kajala. All rights reserved. Consult your license regarding permissions and restrictions.</small><br><br></body></html>
